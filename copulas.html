<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Copulas | Risk Modelling and Survival Analysis</title>
  <meta name="description" content="A modified version of the book on Risk Modelling and Survival Analysis, with additional notes and examples." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Copulas | Risk Modelling and Survival Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A modified version of the book on Risk Modelling and Survival Analysis, with additional notes and examples." />
  <meta name="github-repo" content="priyam0k/CS2" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Copulas | Risk Modelling and Survival Analysis" />
  
  <meta name="twitter:description" content="A modified version of the book on Risk Modelling and Survival Analysis, with additional notes and examples." />
  

<meta name="author" content="Priyam" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
<link rel="prev" href="compound-loss-distributions.html"/>
<link rel="next" href="extreme-value-theory.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Risk Modelling and Survival Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i>Motivation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="r-setup.html"><a href="r-setup.html"><i class="fa fa-check"></i><b>1</b> R Setup</a>
<ul>
<li class="chapter" data-level="1.1" data-path="r-setup.html"><a href="r-setup.html#preparing-your-environment"><i class="fa fa-check"></i><b>1.1</b> Preparing your environment</a></li>
<li class="chapter" data-level="1.2" data-path="r-setup.html"><a href="r-setup.html#basic-interations-with-r"><i class="fa fa-check"></i><b>1.2</b> Basic interations with R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="loss-distributions.html"><a href="loss-distributions.html"><i class="fa fa-check"></i><b>2</b> Loss distributions</a>
<ul>
<li class="chapter" data-level="" data-path="loss-distributions.html"><a href="loss-distributions.html#objectives-loss-distributions"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="loss-distributions.html"><a href="loss-distributions.html#theory-loss-distributions"><i class="fa fa-check"></i>Theory</a></li>
<li class="chapter" data-level="" data-path="loss-distributions.html"><a href="loss-distributions.html#practice-loss-distributions"><i class="fa fa-check"></i><code>R</code> Practice</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="compound-loss-distributions.html"><a href="compound-loss-distributions.html"><i class="fa fa-check"></i><b>3</b> Compound loss distributions</a>
<ul>
<li class="chapter" data-level="" data-path="compound-loss-distributions.html"><a href="compound-loss-distributions.html#objectives-compound-loss-distributions"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="compound-loss-distributions.html"><a href="compound-loss-distributions.html#theory-compound-loss-distributions"><i class="fa fa-check"></i>Theory</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="compound-loss-distributions.html"><a href="compound-loss-distributions.html#chapter-compound-loss-distributions"><i class="fa fa-check"></i><b>3.0.1</b> <strong>Chapter: Compound Loss Distributions</strong></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="compound-loss-distributions.html"><a href="compound-loss-distributions.html#practice-compound-loss-distributions"><i class="fa fa-check"></i><code>R</code> Practice</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="copulas.html"><a href="copulas.html"><i class="fa fa-check"></i><b>4</b> Copulas</a>
<ul>
<li class="chapter" data-level="" data-path="copulas.html"><a href="copulas.html#objectives-copulas"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="copulas.html"><a href="copulas.html#theory-copulas"><i class="fa fa-check"></i>Theory</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="copulas.html"><a href="copulas.html#chapter-copulas-modelling-dependency-structures"><i class="fa fa-check"></i><b>4.0.1</b> <strong>Chapter: Copulas – Modelling Dependency Structures</strong></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="copulas.html"><a href="copulas.html#practice-copulas"><i class="fa fa-check"></i><code>R</code> Practice</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="extreme-value-theory.html"><a href="extreme-value-theory.html"><i class="fa fa-check"></i><b>5</b> Extreme value theory</a>
<ul>
<li class="chapter" data-level="" data-path="extreme-value-theory.html"><a href="extreme-value-theory.html#objectives-evt"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="extreme-value-theory.html"><a href="extreme-value-theory.html#theory-evt"><i class="fa fa-check"></i>Theory</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="extreme-value-theory.html"><a href="extreme-value-theory.html#chapter-16-extreme-value-theory"><i class="fa fa-check"></i><b>5.0.1</b> Chapter 16: Extreme Value Theory</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extreme-value-theory.html"><a href="extreme-value-theory.html#practice-evt"><i class="fa fa-check"></i><code>R</code> Practice</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>6</b> Time series</a>
<ul>
<li class="chapter" data-level="" data-path="time-series.html"><a href="time-series.html#objectives-time-series"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="6.1" data-path="time-series.html"><a href="time-series.html#theory-time-series"><i class="fa fa-check"></i><b>6.1</b> Theory</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="time-series.html"><a href="time-series.html#time-series-a-deep-dive-for-cs2-actuarial-professionals"><i class="fa fa-check"></i><b>6.1.1</b> Time Series: A Deep Dive for CS2 Actuarial Professionals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="time-series.html"><a href="time-series.html#practice-time-series"><i class="fa fa-check"></i><code>R</code> Practice</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="stochastic-processes.html"><a href="stochastic-processes.html"><i class="fa fa-check"></i><b>7</b> Stochastic processes</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-processes.html"><a href="stochastic-processes.html#objectives-stochastic-processes"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="stochastic-processes.html"><a href="stochastic-processes.html#theory-stochastic-processes"><i class="fa fa-check"></i>Theory</a>
<ul>
<li class="chapter" data-level="7.0.1" data-path="stochastic-processes.html"><a href="stochastic-processes.html#chapter-1-stochastic-processes"><i class="fa fa-check"></i><b>7.0.1</b> Chapter 1: Stochastic Processes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-processes.html"><a href="stochastic-processes.html#practice-stochastic-processes"><i class="fa fa-check"></i><code>R</code> Practice</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="markov-chains.html"><a href="markov-chains.html"><i class="fa fa-check"></i><b>8</b> Markov chains</a>
<ul>
<li class="chapter" data-level="" data-path="markov-chains.html"><a href="markov-chains.html#objectives-markov-chains"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="markov-chains.html"><a href="markov-chains.html#theory-markov-chains"><i class="fa fa-check"></i>Theory</a></li>
<li class="chapter" data-level="8.1" data-path="markov-chains.html"><a href="markov-chains.html#features-of-a-markov-chain-model"><i class="fa fa-check"></i><b>8.1</b> Features of a Markov chain model</a></li>
<li class="chapter" data-level="8.2" data-path="markov-chains.html"><a href="markov-chains.html#chapman-kolmogorov-equations"><i class="fa fa-check"></i><b>8.2</b> Chapman-Kolmogorov equations</a></li>
<li class="chapter" data-level="8.3" data-path="markov-chains.html"><a href="markov-chains.html#stationary-distribution-for-a-markov-chain"><i class="fa fa-check"></i><b>8.3</b> Stationary distribution for a Markov chain</a></li>
<li class="chapter" data-level="8.4" data-path="markov-chains.html"><a href="markov-chains.html#frequency-based-experience-rating"><i class="fa fa-check"></i><b>8.4</b> Frequency based experience rating</a></li>
<li class="chapter" data-level="8.5" data-path="markov-chains.html"><a href="markov-chains.html#time-inhomogeneous-markov-chain-model"><i class="fa fa-check"></i><b>8.5</b> Time-inhomogeneous Markov chain model</a></li>
<li class="chapter" data-level="8.6" data-path="markov-chains.html"><a href="markov-chains.html#markov-chains-in-modelling"><i class="fa fa-check"></i><b>8.6</b> Markov chains in modelling</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="markov-chains.html"><a href="markov-chains.html#simulating-a-markov-chain"><i class="fa fa-check"></i><b>8.6.1</b> Simulating a Markov chain</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chains.html"><a href="markov-chains.html#practice-markov-chains"><i class="fa fa-check"></i><code>R</code> Practice</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="markov-processes.html"><a href="markov-processes.html"><i class="fa fa-check"></i><b>9</b> Markov processes</a>
<ul>
<li class="chapter" data-level="" data-path="markov-processes.html"><a href="markov-processes.html#objectives-09"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="markov-processes.html"><a href="markov-processes.html#theory-09"><i class="fa fa-check"></i>Theory</a></li>
<li class="chapter" data-level="9.1" data-path="markov-processes.html"><a href="markov-processes.html#features-of-a-markov-process-model"><i class="fa fa-check"></i><b>9.1</b> Features of a Markov process model</a></li>
<li class="chapter" data-level="9.2" data-path="markov-processes.html"><a href="markov-processes.html#poisson-process"><i class="fa fa-check"></i><b>9.2</b> Poisson process</a></li>
<li class="chapter" data-level="9.3" data-path="markov-processes.html"><a href="markov-processes.html#kolmogorov-equations-for-a-markov-process"><i class="fa fa-check"></i><b>9.3</b> Kolmogorov equations for a Markov process</a></li>
<li class="chapter" data-level="9.4" data-path="markov-processes.html"><a href="markov-processes.html#solving-kolmogorv-equations"><i class="fa fa-check"></i><b>9.4</b> Solving Kolmogorv equations</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="markov-processes.html"><a href="markov-processes.html#simple-cases"><i class="fa fa-check"></i><b>9.4.1</b> Simple cases</a></li>
<li class="chapter" data-level="9.4.2" data-path="markov-processes.html"><a href="markov-processes.html#more-general-cases"><i class="fa fa-check"></i><b>9.4.2</b> More general cases</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="markov-processes.html"><a href="markov-processes.html#sickness-and-marriage-models"><i class="fa fa-check"></i><b>9.5</b> Sickness and marriage models</a></li>
<li class="chapter" data-level="9.6" data-path="markov-processes.html"><a href="markov-processes.html#markov-jump-process"><i class="fa fa-check"></i><b>9.6</b> Markov jump process</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="markov-processes.html"><a href="markov-processes.html#simulating-a-markov-jump-process"><i class="fa fa-check"></i><b>9.6.1</b> Simulating a Markov jump process</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-processes.html"><a href="markov-processes.html#practice-09"><i class="fa fa-check"></i><code>R</code> Practice</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="survival-models.html"><a href="survival-models.html"><i class="fa fa-check"></i><b>10</b> Survival models</a></li>
<li class="chapter" data-level="11" data-path="lifetime-distributions.html"><a href="lifetime-distributions.html"><i class="fa fa-check"></i><b>11</b> Lifetime distributions</a></li>
<li class="chapter" data-level="12" data-path="transition-intensities.html"><a href="transition-intensities.html"><i class="fa fa-check"></i><b>12</b> Estimating transition intensities</a></li>
<li class="chapter" data-level="13" data-path="graduation.html"><a href="graduation.html"><i class="fa fa-check"></i><b>13</b> Graduation</a></li>
<li class="chapter" data-level="14" data-path="mortality-projection.html"><a href="mortality-projection.html"><i class="fa fa-check"></i><b>14</b> Mortality projection</a></li>
<li class="chapter" data-level="15" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>15</b> Machine learning</a>
<ul>
<li class="chapter" data-level="" data-path="machine-learning.html"><a href="machine-learning.html#objectives-15"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="machine-learning.html"><a href="machine-learning.html#theory-15"><i class="fa fa-check"></i>Theory</a></li>
<li class="chapter" data-level="15.1" data-path="machine-learning.html"><a href="machine-learning.html#machine-learning-topics"><i class="fa fa-check"></i><b>15.1</b> Machine learning topics</a></li>
<li class="chapter" data-level="15.2" data-path="machine-learning.html"><a href="machine-learning.html#machine-learning-from-data"><i class="fa fa-check"></i><b>15.2</b> Machine learning from data</a></li>
<li class="chapter" data-level="15.3" data-path="machine-learning.html"><a href="machine-learning.html#supervised-machine-learning"><i class="fa fa-check"></i><b>15.3</b> Supervised machine learning</a></li>
<li class="chapter" data-level="15.4" data-path="machine-learning.html"><a href="machine-learning.html#unsupervised-machine-learning"><i class="fa fa-check"></i><b>15.4</b> Unsupervised machine learning</a></li>
<li class="chapter" data-level="15.5" data-path="machine-learning.html"><a href="machine-learning.html#penalised-regression"><i class="fa fa-check"></i><b>15.5</b> Penalised regression</a></li>
<li class="chapter" data-level="15.6" data-path="machine-learning.html"><a href="machine-learning.html#decision-trees"><i class="fa fa-check"></i><b>15.6</b> Decision trees</a></li>
<li class="chapter" data-level="15.7" data-path="machine-learning.html"><a href="machine-learning.html#perspectives-of-non-actuarial-professionals"><i class="fa fa-check"></i><b>15.7</b> Perspectives of non-actuarial professionals</a></li>
<li class="chapter" data-level="" data-path="machine-learning.html"><a href="machine-learning.html#practice-15"><i class="fa fa-check"></i><code>R</code> Practice</a></li>
</ul></li>
<li class="divider"></li>
<li>Adapted by <a href="https://github.com/priyam0k">Priyam</a> from the original by <a href="https://github.com/agarbiak" target="blank">Alex Garbiak</a>.</li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Risk Modelling and Survival Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="copulas" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Copulas<a href="copulas.html#copulas" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="objectives-copulas" class="section level2 unnumbered hasAnchor">
<h2>Learning Objectives<a href="copulas.html#objectives-copulas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Describe how a copula can be characterised as a multivariate distribution function which is a function of the marginal distribution functions of its variates, and explain how this allows the marginal distributions to be investigated separately from the dependency between them.</li>
<li>Explain the meaning of the terms dependence or concordance, upper and lower tail dependence; and state in general terms how tail dependence can be used to help select a copula suitable for modelling particular types of risk.</li>
<li>Describe the form and characteristics of the Gaussian copula and the Archimedean family of copulas.</li>
</ol>
</div>
<div id="theory-copulas" class="section level2 unnumbered hasAnchor">
<h2>Theory<a href="copulas.html#theory-copulas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<div id="chapter-copulas-modelling-dependency-structures" class="section level3 hasAnchor" number="4.0.1">
<h3><span class="header-section-number">4.0.1</span> <strong>Chapter: Copulas – Modelling Dependency Structures</strong><a href="copulas.html#chapter-copulas-modelling-dependency-structures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This chapter, covered in detail in Chapter 17 of your CS2 Course Notes, is all about understanding and quantifying the relationships between random variables, particularly in complex risk scenarios. Insurance and investment firms frequently need to compute the joint probability of events, such as combined losses across different business lines or simultaneous defaults on investments. While traditional methods involving joint Probability Density Functions (PDFs) or probability functions exist, they often come with drawbacks, such as the difficulty in fully specifying the joint distribution or clearly seeing the nature of the association. This is where copulas shine, offering an elegant alternative.</p>
<hr />
<p><strong>Learning Objective 1: Describe how a copula can be characterised as a multivariate distribution function which is a function of the marginal distribution functions of its variates, and explain how this allows the marginal distributions to be investigated separately from the dependency between them.</strong></p>
<p>At its core, a copula is a <strong>function</strong> that translates marginal Cumulative Distribution Functions (CDFs) into a joint CDF. Think of it as a blueprint for dependence: it <em>explicitly</em> describes how variables are interdependent, allowing us to disentangle this dependency from their individual (marginal) distributions.</p>
<ol style="list-style-type: decimal">
<li><strong>Definition and Characterisation:</strong>
<ul>
<li>For a bivariate distribution, the copula, denoted <span class="math inline">\(C\)</span>, is defined such that:
<span class="math inline">\(C(F_X(x), F_Y(y)) = P(X \le x, Y \le y) = F_{X,Y}(x,y)\)</span>.</li>
<li>This is often written in a more compact form: <span class="math inline">\(C(u,v) = F_{X,Y}(x,y)\)</span>, where <span class="math inline">\(u = F_X(x)\)</span> and <span class="math inline">\(v = F_Y(y)\)</span> are the marginal probabilities (and thus restricted to the range $$).</li>
<li>This definition extends directly to the multivariate case with <span class="math inline">\(d\)</span> dimensions: <span class="math inline">\(C(u_1, u_2, ..., u_d) = F_{X_1, X_2, ..., X_d}(x_1, x_2, ..., x_d)\)</span>, where <span class="math inline">\(u_i = F_{X_i}(x_i)\)</span>.</li>
<li><strong>Key Insight:</strong> This formulation implies that the copula captures the dependency structure based on the <em>rankings</em> or <em>percentiles</em> of the data, rather than their exact values.</li>
</ul></li>
<li><strong>Separation of Marginals and Dependency:</strong>
<ul>
<li>The beauty of copulas lies in this decomposition. Traditional joint distributions implicitly blend the marginal behaviour with the dependence structure. With copulas, we can:
<ul>
<li><strong>Specify marginals independently:</strong> We can model each variable’s distribution (<span class="math inline">\(F_X(x)\)</span>, <span class="math inline">\(F_Y(y)\)</span>, etc.) using appropriate statistical distributions (e.g., a Gamma for losses, a Normal for returns), without worrying about how they interact.</li>
<li><strong>Model dependence separately:</strong> The copula function then explicitly defines how these marginals are linked. This “deconstruction” allows actuaries to adjust either the marginal distributions or the dependence structure without affecting the other, providing immense flexibility in risk modelling.</li>
</ul></li>
</ul></li>
<li><strong>Sklar’s Theorem – The Mathematical Foundation:</strong>
<ul>
<li>This fundamental theorem, demonstrated by Sklar in 1959, rigorously proves the existence of such a decomposition:
<ul>
<li><strong>Theorem:</strong> If <span class="math inline">\(F\)</span> is a joint CDF with marginal CDFs <span class="math inline">\(F_1, ..., F_d\)</span>, then there exists a copula <span class="math inline">\(C\)</span> such that for all <span class="math inline">\(x_1, ..., x_d\)</span> in <span class="math inline">\(\mathbb{R}\)</span>: <span class="math inline">\(F(x_1, ..., x_d) = C(F_1(x_1), ..., F_d(x_d))\)</span>.</li>
<li><strong>Uniqueness:</strong> For variables with continuous distributions, this copula <span class="math inline">\(C\)</span> is unique.</li>
<li><strong>Converse:</strong> The converse also holds: if <span class="math inline">\(C\)</span> is a copula and <span class="math inline">\(F_1, ..., F_d\)</span> are univariate CDFs, then the function <span class="math inline">\(F\)</span> defined as <span class="math inline">\(C(F_1(x_1), ..., F_d(x_d))\)</span> is a valid joint CDF with the specified marginals.</li>
</ul></li>
</ul></li>
<li><strong>Properties of Copulas:</strong>
<ul>
<li>To ensure they correctly capture properties expected of a joint distribution, copulas must satisfy three technical properties:
<ol style="list-style-type: decimal">
<li><strong>Monotonicity:</strong> A copula must be an increasing function of each of its inputs.</li>
<li><strong>Boundary Conditions:</strong> If all but one marginal CDF input is equal to 1, the copula’s output is equal to the value of the remaining marginal CDF. For example, <span class="math inline">\(C(1, ..., u_i, ..., 1) = u_i\)</span>.</li>
<li><strong>Range:</strong> A copula function must always return a valid probability, meaning its output value must be within the range $$.</li>
</ol></li>
</ul></li>
</ol>
<hr />
<p><strong>Learning Objective 2: Explain the meaning of the terms dependence or concordance, upper and lower tail dependence; and state in general terms how tail dependence can be used to help select a copula suitable for modelling particular types of risk.</strong></p>
<p>Understanding dependence is paramount in risk modelling, especially when extreme events are concerned. Copulas offer nuanced measures beyond simple correlation.</p>
<ol style="list-style-type: decimal">
<li><strong>Dependence, Association, and Concordance [1.3.2, 76, 81, 133, 134, 458, 493, 615]:</strong>
<ul>
<li><strong>Association/Dependence:</strong> Variables are associated if there is <em>any</em> form of statistical relationship between them, whether causal or not.</li>
<li><strong>Concordance:</strong> Two random variables are concordant if small values of one are likely to be associated with small values of the other, and vice versa. Conversely, they are discordant if small values of one are associated with large values of the other.</li>
<li><strong>Measures of Association:</strong>
<ul>
<li><strong>Pearson’s Rho (<span class="math inline">\(\rho\)</span>):</strong> This measures <em>linear</em> correlation, taking values between -1 and +1.
<ul>
<li><span class="math inline">\(\rho = +1\)</span>: Perfect positive linear relationship.</li>
<li><span class="math inline">\(\rho = -1\)</span>: Perfect negative linear relationship.</li>
<li><span class="math inline">\(\rho = 0\)</span>: No <em>linear</em> relationship (uncorrelated). This does not necessarily imply independence; non-linear relationships could still exist.</li>
</ul></li>
<li><strong>Rank Correlation (Spearman’s Rho, Kendall’s Tau):</strong> These measures assess <em>monotonic</em> association and are more robust to non-linear transformations. Kendall’s Tau is particularly relevant for fitting Archimedean copulas, as it can often be expressed as a function of the copula’s parameters.</li>
</ul></li>
</ul></li>
<li><strong>Upper and Lower Tail Dependence [1.3.2, 76, 90, 92, 124, 142, 458, 461, 493, 615]:</strong>
<ul>
<li>These concepts measure the strength of dependence between random variables specifically in the <em>extreme tails</em> of their joint distribution, i.e., when both variables take on very small (lower tail) or very large (upper tail) values. This is crucial for risks like large losses that tend to occur together.</li>
<li><strong>Coefficient of Lower Tail Dependence (<span class="math inline">\(\lambda_L\)</span>):</strong> Measures dependence when variables are simultaneously small [1.3.2, 90, 91, 124, 142, 330, 461, 465, 494]. It is defined as:
<span class="math inline">\(\lambda_L = \lim_{u \to 0^+} P(X \le F_X^{-1}(u) | Y \le F_Y^{-1}(u))\)</span>.
In terms of the copula function: <span class="math inline">\(\lambda_L = \lim_{u \to 0^+} \frac{C(u,u)}{u}\)</span>.
It ranges from 0 (no dependence) to 1 (full dependence).</li>
<li><strong>Coefficient of Upper Tail Dependence (<span class="math inline">\(\lambda_U\)</span>):</strong> Measures dependence when variables are simultaneously large [1.3.2, 92, 124, 143, 461, 467, 494]. It is defined as:
<span class="math inline">\(\lambda_U = \lim_{u \to 1^-} P(X &gt; F_X^{-1}(u) | Y &gt; F_Y^{-1}(u))\)</span>.
In terms of the copula function: <span class="math inline">\(\lambda_U = \lim_{u \to 1^-} \frac{1 - 2u + C(u,u)}{1-u}\)</span>.
Alternatively, using the <em>survival copula</em> <span class="math inline">\(\bar{C}(u,v) = P(X&gt;x, Y&gt;y)\)</span>: <span class="math inline">\(\lambda_U = \lim_{u \to 0^+} \frac{\bar{C}(u,u)}{u}\)</span>. (Note: The survival copula is related to the original copula by <span class="math inline">\(\bar{C}(u,v) = u + v - 1 + C(1-u, 1-v)\)</span>.)</li>
</ul></li>
<li><strong>Using Tail Dependence for Copula Selection [1.3.2, 76, 124, 144, 356, 458, 479, 492, 500]:</strong>
<ul>
<li>The presence and degree of upper or lower tail dependence in empirical data are crucial indicators for selecting an appropriate copula model.</li>
<li>For instance, if large general insurance claims stemming from a common underlying cause are being modelled, where severe claims are likely to occur together, a copula with strong upper tail dependence would be suitable.</li>
<li>Conversely, if modelling scenarios where poor returns on investments are highly correlated (e.g., during a market crash), a copula with strong lower tail dependence would be preferred.</li>
<li>The table below summarizes the tail dependence characteristics for key copulas:</li>
</ul></li>
</ol>
<table>
<colgroup>
<col width="16%" />
<col width="41%" />
<col width="41%" />
</colgroup>
<thead>
<tr>
<th align="left">Copula Name</th>
<th align="left"><span class="math inline">\(\lambda_L\)</span></th>
<th align="left"><span class="math inline">\(\lambda_U\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Independence</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Co-monotonic</td>
<td align="left">1</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">Counter-monotonic</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Gumbel</td>
<td align="left">0</td>
<td align="left"><span class="math inline">\(2 - 2^{1/\alpha}\)</span> (for <span class="math inline">\(\alpha \ge 1\)</span>)</td>
</tr>
<tr>
<td align="left">Clayton</td>
<td align="left"><span class="math inline">\(2^{-1/\alpha}\)</span> (for <span class="math inline">\(\alpha &gt; 0\)</span>); 0 (for <span class="math inline">\(\alpha \le 0\)</span>)</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Frank</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Gaussian</td>
<td align="left">0 (if <span class="math inline">\(\rho &lt; 1\)</span>); 1 (if <span class="math inline">\(\rho = 1\)</span>)</td>
<td align="left">0 (if <span class="math inline">\(\rho &lt; 1\)</span>); 1 (if <span class="math inline">\(\rho = 1\)</span>)</td>
</tr>
<tr>
<td align="left">Student’s t</td>
<td align="left">&gt;0 (if <span class="math inline">\(\gamma &lt; \infty\)</span>); 0 (if <span class="math inline">\(\gamma = \infty, \rho \ne 1\)</span>)</td>
<td align="left">&gt;0 (if <span class="math inline">\(\gamma &lt; \infty\)</span>); 0 (if <span class="math inline">\(\gamma = \infty, \rho \ne 1\)</span>)</td>
</tr>
</tbody>
</table>
<pre><code>*   For instance, if data exhibits high upper tail dependence but no lower tail dependence, the Gumbel copula is appropriate. If it shows high lower tail dependence but no upper tail dependence, the Clayton copula is suitable. If there is no tail dependence, the Frank or Gaussian copulas could be used. If both upper and lower tail dependence are present, the Student&#39;s t copula is a strong candidate.</code></pre>
<hr />
<p><strong>Learning Objective 3: Describe the form and characteristics of the Gaussian copula and the Archimedean family of copulas.</strong></p>
<p>Copulas are broadly classified into fundamental, explicit (including Archimedean), and implicit types.</p>
<ol style="list-style-type: decimal">
<li><strong>Fundamental Copulas:</strong>
<ul>
<li>These represent the three basic dependency extremes: independence, perfect positive interdependence, and perfect negative interdependence. They are specific cases of Fréchet-Höffding copulas and form the upper and lower bounds for all copulas.</li>
<li><strong>Independence (Product) Copula:</strong>
<ul>
<li>Form: <span class="math inline">\(C(u,v) = uv\)</span>.</li>
<li>Characteristics: Captures independence between variables. It has zero dependence in both tails (<span class="math inline">\(\lambda_L = 0, \lambda_U = 0\)</span>).</li>
</ul></li>
<li><strong>Co-monotonic (Minimum) Copula:</strong>
<ul>
<li>Form: <span class="math inline">\(C(u,v) = \min(u,v)\)</span>.</li>
<li>Characteristics: Describes perfect positive interdependence. Both upper and lower tail dependence coefficients are 1 (<span class="math inline">\(\lambda_L = 1, \lambda_U = 1\)</span>).</li>
</ul></li>
<li><strong>Counter-monotonic (Maximum) Copula:</strong>
<ul>
<li>Form: <span class="math inline">\(C(u,v) = \max(u+v-1, 0)\)</span>.</li>
<li>Characteristics: Captures perfect negative interdependence. It has zero dependence in both tails (<span class="math inline">\(\lambda_L = 0, \lambda_U = 0\)</span>).</li>
<li><strong>Important Limitation:</strong> This copula <em>cannot</em> be extended to the multivariate case (three or more variables), as it’s impossible for every pair to have a direct inverse relationship.</li>
</ul></li>
<li><strong>Graphical Representation:</strong> Scatterplots vividly illustrate these dependencies:
<ul>
<li>Product copula: Points are scattered randomly within the square.</li>
<li>Co-monotonic copula: Points lie along the diagonal <span class="math inline">\(u=v\)</span>.</li>
<li>Counter-monotonic copula: Points lie along the diagonal <span class="math inline">\(u=1-v\)</span>.</li>
<li>3D representations and contour plots also provide visual insights into the copula’s surface.</li>
</ul></li>
</ul></li>
<li><strong>Archimedean Family of Copulas [1.3.3, 76, 114, 137, 348, 472, 497]:</strong>
<ul>
<li><p>This is a significant subclass of explicit copulas, meaning they have simple closed-form expressions. They are defined by a <strong>generator function</strong>, <span class="math inline">\(\psi(x)\)</span>, which simplifies the process of creating valid copulas.</p></li>
<li><p><strong>General Form (bivariate):</strong> <span class="math inline">\(C(u,v) = \psi^{-1}(\psi(u) + \psi(v))\)</span>. This process involves transforming probabilities, summing them, and then transforming back.</p></li>
<li><p><strong>Generator Function Properties:</strong> For <span class="math inline">\(\psi(x)\)</span> to be a valid generator for a copula, it must be:</p>
<ol style="list-style-type: decimal">
<li>Continuous and strictly decreasing on $$.</li>
<li>Convex.</li>
<li><span class="math inline">\(\psi(1) = 0\)</span>.</li>
</ol></li>
<li><p><strong>Examples:</strong> The Gumbel, Clayton, Frank, and even the Independence copulas are all Archimedean. The parameter <span class="math inline">\(\alpha\)</span> in these copulas allows for adjusting the strength of dependence.</p></li>
<li><p><strong>Gumbel Copula [1.3.3, 76, 109, 138, 341, 471, 498]:</strong></p>
<ul>
<li>Form: <span class="math inline">\(C(u,v) = \exp \left( -[(\ln u)^\alpha + (\ln v)^\alpha]^{1/\alpha} \right)\)</span> for <span class="math inline">\(\alpha \ge 1\)</span>. (Also known as Gumbel-Hougaard copula).</li>
<li>Generator Function: <span class="math inline">\(\psi(t) = -(\ln t)^\alpha\)</span>.</li>
<li>Characteristics: Exhibits <strong>upper tail dependence</strong> but <strong>no lower tail dependence</strong>. As <span class="math inline">\(\alpha\)</span> increases, the degree of upper tail dependence increases. Suitable for modelling risks where large values tend to occur together.</li>
</ul></li>
<li><p><strong>Clayton Copula [1.3.3, 76, 111, 138, 343, 472, 498]:</strong></p>
<ul>
<li>Form: <span class="math inline">\(C(u,v) = (u^{-\alpha} + v^{-\alpha} - 1)^{-1/\alpha}\)</span> for <span class="math inline">\(\alpha \ge -1, \alpha \ne 0\)</span>. For <span class="math inline">\(\alpha &gt; 0\)</span>, it simplifies nicely.</li>
<li>Generator Function: <span class="math inline">\(\psi(t) = \frac{1}{\alpha}(t^{-\alpha} - 1)\)</span>.</li>
<li>Characteristics: Exhibits <strong>lower tail dependence</strong> but <strong>no upper tail dependence</strong>. Increasing <span class="math inline">\(\alpha\)</span> increases the lower tail dependence. Useful when extreme low or negative events are thought to happen together (e.g., market crashes).</li>
</ul></li>
<li><p><strong>Frank Copula [1.3.3, 76, 113, 139, 346, 472, 498]:</strong></p>
<ul>
<li>Form: <span class="math inline">\(C(u,v) = -\frac{1}{\alpha} \ln\left(1 + \frac{(e^{-\alpha u}-1)(e^{-\alpha v}-1)}{e^{-\alpha}-1}\right)\)</span> for <span class="math inline">\(\alpha \ne 0\)</span>.</li>
<li>Generator Function: <span class="math inline">\(\psi(t) = -\ln\left(\frac{e^{-\alpha t}-1}{e^{-\alpha}-1}\right)\)</span>.</li>
<li>Characteristics: Exhibits <strong>no upper or lower tail dependence</strong>. Useful when variables are uncorrelated in their tails, like equity and bond returns.</li>
</ul></li>
</ul></li>
<li><strong>Gaussian Copula [1.3.3, 76, 120, 140, 352, 476, 499]:</strong>
<ul>
<li>This is an example of an <strong>implicit copula</strong>, meaning it’s based on well-known multivariate distributions but doesn’t have a simple closed-form expression from a generator function.</li>
<li>Form (bivariate): <span class="math inline">\(C(u,v) = \Phi_\rho^{-1}(\Phi^{-1}(u), \Phi^{-1}(v))\)</span>.
<ul>
<li>Here, <span class="math inline">\(\Phi\)</span> is the CDF of the standard normal distribution, and <span class="math inline">\(\Phi_\rho\)</span> is the CDF of a bivariate normal distribution with correlation <span class="math inline">\(\rho\)</span>.</li>
</ul></li>
<li>Characteristics:
<ul>
<li>When applied to normal marginal distributions, it results in a bivariate normal distribution with correlation <span class="math inline">\(\rho\)</span>.</li>
<li>Exhibits <strong>zero dependence in both tails</strong> when <span class="math inline">\(\rho &lt; 1\)</span>, but full dependence when <span class="math inline">\(\rho = 1\)</span>.</li>
<li>Special cases: The independence (<span class="math inline">\(\rho=0\)</span>), co-monotonic (<span class="math inline">\(\rho=+1\)</span>), and counter-monotonic (<span class="math inline">\(\rho=-1\)</span>) copulas are all special cases of the Gaussian copula.</li>
</ul></li>
</ul></li>
<li><strong>Student’s t Copula [1.3.3, 123, 141, 354, 478, 499]:</strong>
<ul>
<li>Another implicit copula, based on the multivariate Student’s t distribution.</li>
<li>Form (bivariate): <span class="math inline">\(C(u,v) = t_{\gamma,\rho}^{-1}(t_\gamma^{-1}(u), t_\gamma^{-1}(v))\)</span>.
<ul>
<li>Here, <span class="math inline">\(t_\gamma\)</span> is the CDF of a Student’s t distribution with <span class="math inline">\(\gamma\)</span> degrees of freedom, and <span class="math inline">\(t_{\gamma,\rho}\)</span> is the CDF of a bivariate Student’s t distribution with <span class="math inline">\(\gamma\)</span> degrees of freedom and correlation <span class="math inline">\(\rho\)</span>.</li>
</ul></li>
<li>Characteristics:
<ul>
<li>Offers <strong>more flexibility</strong> than the Gaussian copula due to the extra parameter, <span class="math inline">\(\gamma\)</span> (degrees of freedom).</li>
<li>Exhibits <strong>equal positive dependence in both tails</strong> if <span class="math inline">\(\gamma\)</span> is finite. This tail dependence increases as <span class="math inline">\(\gamma\)</span> decreases.</li>
<li>The Gaussian copula is the <strong>limiting case</strong> of the Student’s t copula as the number of degrees of freedom (<span class="math inline">\(\gamma\)</span>) tends to infinity. Suitable when both extreme positive and negative events are correlated.</li>
</ul></li>
</ul></li>
</ol>
<hr />
<p><strong>Choosing and Fitting a Suitable Copula Function:</strong></p>
<p>When constructing a mathematical model for real-world phenomena, such as financial or insurance risks, the selection of an appropriate copula is crucial. The process generally involves:
1. <strong>Marginal Distribution Selection:</strong> Parameterising the marginal distributions for each relevant variable.
2. <strong>Dependence Structure Examination:</strong> Describing and quantifying the form and extent of associations between the variables. This is where insights from tail dependence measures play a vital role. For instance, if you observe strong positive correlation in the extreme upper tail of your data (e.g., very large losses occurring together), a Gumbel copula might be a strong candidate.
3. <strong>Parameter Estimation:</strong> Once a copula type is chosen, its parameters need to be estimated. For Archimedean copulas, a “method of moments” approach using Kendall’s tau is common. The observed Kendall’s tau from the data is equated to its theoretical formula for the chosen copula, and the copula’s parameter (e.g., <span class="math inline">\(\alpha\)</span>) is solved for. Maximum Likelihood Estimation (MLE) is another widely used method for fitting copula parameters.</p>
<hr />
<p>By thoroughly grasping these concepts, you’ll be well-prepared to tackle CS2 exam questions on copulas, not just calculating probabilities, but also critically evaluating their suitability for various risk modelling applications. Keep practising with diverse scenarios!</p>
</div>
</div>
<div id="practice-copulas" class="section level2 unnumbered hasAnchor">
<h2><code>R</code> Practice<a href="copulas.html#practice-copulas" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="compound-loss-distributions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="extreme-value-theory.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": false,
    "twitter": true,
    "linkedin": true,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["twitter", "linkedin"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/priyam0k/CS2/edit/main/04-copulas.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true
  },
  "toolbar": {
    "position": "fixed"
  },
  "info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
